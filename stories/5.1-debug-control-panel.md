---
title: "Story 5.1 - Debug Control Panel: UI for Triggering All Debug Flags"
status: "Ready for Development"
epic: "Epic 5: Debug Control Panel + UI Polish"
priority: "P0"
story_size: "Large"
estimated_hours: 6
created_at: "2025-11-11"
modified_at: "2025-11-11"
---

## Summary

Create an interactive debug control panel UI component that allows developers to easily trigger all 4 debug flags (validation_error, processing_error, queue_delay, dlq_routing) without manual API calls. The panel should provide a user-friendly interface with clear descriptions, input fields for customization, and immediate visual feedback on submission.

## Business Value

Developers and demonstration audiences can immediately test all error pathways and system behavior through the UI without needing to craft manual API requests. This makes the system's reliability and error handling capabilities immediately visible and testable. The debug control panel is central to the "showcase" aspect of the project.

## Technical Context

**From PRD (FR-1.3: Debug Capabilities):**
- System MUST support debug query parameters on POST /events:
  - `?debug=validation_error` - Force validation failure response
  - `?debug=processing_error` - Force processing error
  - `?debug=queue_delay` - Inject artificial latency
  - `?debug=dlq_routing` - Force Dead Letter Queue routing
- Debug flags MUST trigger realistic error pathways for testing

**From PRD (FR-5.3: Debug Control Panel):**
- Dashboard MUST provide UI controls to:
  - Submit test events with debug flags
  - Trigger validation failures
  - Simulate processing errors
  - Demonstrate retry logic
  - Force DLQ routing
  - Inject latency for performance testing
- Controls MUST provide immediate visual feedback

**From Architecture:**
- Dashboard is vanilla HTML/CSS/JavaScript (not React)
- Located in `src/ui/index.html` and `src/ui/` directory
- Uses shadcn-inspired components for consistency

## Acceptance Criteria

1. **Debug Panel Container**
   - Distinct section in dashboard with bordered/highlighted styling
   - Title: "Debug Control Panel"
   - Subtitle: "Test error pathways and system behavior"
   - Located in left sidebar or collapsible section for easy access
   - Responsive on mobile (becomes full-width or modal)

2. **Debug Flag Cards (4 cards)**
   - One card for each debug flag: validation_error, processing_error, queue_delay, dlq_routing
   - Each card shows:
     - Flag name (e.g., "Validation Error")
     - Clear description of what the flag does
     - Icon/visual indicator for the error type
     - Button to trigger the flag
     - Checkbox option to include mock event payload

3. **Validation Error Flag Card**
   - Description: "Force a validation error to test error handling"
   - Icon: Exclamation mark in red circle
   - On click: Submits test event with `?debug=validation_error` query param
   - Expected result message: "Should receive 400 Bad Request response"
   - Mock payload: Include optional invalid payload (missing 'payload' field)

4. **Processing Error Flag Card**
   - Description: "Simulate processing failure after event queued"
   - Icon: Lightning bolt in orange circle
   - On click: Submits test event with `?debug=processing_error` query param
   - Expected result message: "Event queued, then processor will fail"
   - Mock payload: Valid event that will fail during processing

5. **Queue Delay Flag Card**
   - Description: "Inject artificial 2-second latency"
   - Icon: Clock in yellow circle
   - On click: Submits test event with `?debug=queue_delay` query param
   - Latency input field (optional override, default 2000ms)
   - Expected result message: "Response delayed by X milliseconds"
   - Show latency timer countdown during submission

6. **DLQ Routing Flag Card**
   - Description: "Force event to Dead Letter Queue after retries"
   - Icon: X in red circle
   - On click: Submits test event with `?debug=dlq_routing` query param
   - Expected result message: "Event will route to DLQ after max retries"
   - Mock payload: Event designed to fail all retry attempts

7. **Mock Event Payload Options**
   - Toggle checkbox: "Include mock payload"
   - If checked, show pre-built templates:
     - "User Created Event" - realistic Zapier user.created payload
     - "Order Placed Event" - realistic order.placed payload
     - "Custom JSON" - textarea for custom JSON input
   - If unchecked, use minimal test payload: `{"payload": {"test": true}}`

8. **Quick Event Generator**
   - Collapsible section in debug panel: "Quick Event Generator"
   - Pre-built templates for common Zapier events:
     - User created
     - Order placed
     - Payment received
     - Webhook received
     - Custom trigger fired
   - Each template shows preview of payload before submission
   - One-click button to submit template event

9. **Debug Submission Feedback**
   - Upon submission, show immediate loading indicator (spinner)
   - Display submitted event_id in real-time as response arrives
   - Show status badge: "Queued", "Processing", "Failed", "DLQ"
   - Display latency if queue_delay flag used
   - Show error response in collapsible details pane if applicable

10. **Debug History Panel**
    - Below debug cards, show log of last 10 debug submissions
    - Columns: Timestamp, Flag, Event ID, Status, Result
    - Expandable rows to see full response body
    - Color-coded by outcome: green (success), yellow (processing), red (error)
    - Clear history button
    - Export history as JSON

11. **Batch Testing Mode**
    - Toggle checkbox: "Batch Testing Mode"
    - If enabled: Submit all 4 flags sequentially with 500ms delay
    - Show progress bar indicating batch progress (4 flags)
    - Collect all responses and display results grid
    - Generate summary report: X flags triggered, X succeeded, X failed

12. **Debug Sidebar Metrics**
    - Compact display in debug panel footer:
      - Total debug events submitted today
      - Last submission timestamp
      - Most used debug flag
    - Quick stats without cluttering main layout

13. **Help & Information**
    - Info icon in debug panel header opens help modal
    - Modal explains each flag's purpose and expected behavior
    - Links to PRD debug flag documentation
    - Common troubleshooting tips
    - Example API calls for reference

14. **Keyboard Shortcuts**
    - Alt+D: Toggle debug panel visibility
    - Alt+1: Quick submit validation_error
    - Alt+2: Quick submit processing_error
    - Alt+3: Quick submit queue_delay
    - Alt+4: Quick submit dlq_routing
    - Help text visible when panel focused

15. **Error Scenario Testing**
    - Dropdown menu: "Pre-configured Scenarios"
    - Common error scenarios:
      - "Test Happy Path" - Valid event, no debug flag
      - "Test All Errors" - Batch mode with all 4 flags
      - "Test Retry Logic" - Multiple processing_error flags
      - "Test DLQ Flow" - Sequence leading to DLQ
      - "Stress Test" - High volume with random flags
    - Click to execute scenario with logging

## Dependencies

- **Story 1.2:** API Worker with POST /events endpoint
- **Story 1.3:** Auth middleware and token validation
- **Story 1.4:** Queue integration
- **Story 1.5:** Error handling and structured responses
- **Story 1.6:** UI skeleton and base dashboard structure
- **Story 2.6:** Existing metrics display for real-time status
- **Story 3.5:** Event inbox to view submitted events

## Technical Specifications

### Debug Panel Component Structure

```html
<!-- src/ui/index.html -->
<div id="debug-panel" class="debug-panel">
  <div class="debug-header">
    <h2>Debug Control Panel</h2>
    <p class="subtitle">Test error pathways and system behavior</p>
    <button id="debug-help-btn" class="help-icon-btn">?</button>
    <button id="debug-toggle-btn" class="collapse-btn">‚àí</button>
  </div>

  <div class="debug-content">
    <!-- Debug Flag Cards -->
    <div class="debug-cards-grid">
      <div class="debug-card" id="validation-error-card">
        <div class="card-header">
          <span class="card-icon">‚ö†Ô∏è</span>
          <h3>Validation Error</h3>
        </div>
        <p class="card-description">Force a validation error to test error handling</p>
        <button class="debug-btn primary" data-debug-flag="validation_error">
          Trigger Validation Error
        </button>
        <p class="expected-result">Expected: 400 Bad Request</p>
      </div>

      <div class="debug-card" id="processing-error-card">
        <div class="card-header">
          <span class="card-icon">‚ö°</span>
          <h3>Processing Error</h3>
        </div>
        <p class="card-description">Simulate processing failure after event queued</p>
        <button class="debug-btn primary" data-debug-flag="processing_error">
          Trigger Processing Error
        </button>
        <p class="expected-result">Expected: Event queued, then processor fails</p>
      </div>

      <div class="debug-card" id="queue-delay-card">
        <div class="card-header">
          <span class="card-icon">üïê</span>
          <h3>Queue Delay</h3>
        </div>
        <p class="card-description">Inject artificial latency</p>
        <div class="input-group">
          <label>Latency (ms):</label>
          <input type="number" id="delay-input" value="2000" min="100" max="30000">
        </div>
        <button class="debug-btn primary" data-debug-flag="queue_delay">
          Inject Latency
        </button>
        <p class="expected-result">Expected: Response delayed by specified ms</p>
      </div>

      <div class="debug-card" id="dlq-routing-card">
        <div class="card-header">
          <span class="card-icon">‚ùå</span>
          <h3>DLQ Routing</h3>
        </div>
        <p class="card-description">Force event to Dead Letter Queue</p>
        <button class="debug-btn primary" data-debug-flag="dlq_routing">
          Trigger DLQ Routing
        </button>
        <p class="expected-result">Expected: Event routes to DLQ after retries</p>
      </div>
    </div>

    <!-- Mock Payload Options -->
    <div class="debug-section">
      <h4>Mock Payload Configuration</h4>
      <label class="checkbox-label">
        <input type="checkbox" id="mock-payload-toggle" checked>
        Include mock event payload
      </label>
      <select id="payload-template" class="payload-select">
        <option value="minimal">Minimal Test (empty payload)</option>
        <option value="user-created">User Created Event</option>
        <option value="order-placed">Order Placed Event</option>
        <option value="custom">Custom JSON</option>
      </select>
      <textarea id="custom-payload" class="custom-payload hidden"
                placeholder='{"payload": {"custom": "data"}}'></textarea>
    </div>

    <!-- Quick Event Generator -->
    <div class="debug-section">
      <h4>Quick Event Generator</h4>
      <div class="quick-templates">
        <button class="template-btn" data-template="user-created">User Created</button>
        <button class="template-btn" data-template="order-placed">Order Placed</button>
        <button class="template-btn" data-template="payment">Payment Received</button>
        <button class="template-btn" data-template="webhook">Webhook Received</button>
      </div>
    </div>

    <!-- Batch Testing Mode -->
    <div class="debug-section">
      <label class="checkbox-label">
        <input type="checkbox" id="batch-mode-toggle">
        Batch Testing Mode (submit all flags)
      </label>
      <div id="batch-progress" class="progress-bar hidden">
        <div id="batch-progress-fill" class="progress-fill"></div>
        <span id="batch-progress-text" class="progress-text">0/4</span>
      </div>
    </div>

    <!-- Debug History -->
    <div class="debug-section">
      <div class="section-header">
        <h4>Debug History</h4>
        <button id="clear-history-btn" class="btn-text">Clear</button>
      </div>
      <div id="debug-history" class="debug-history">
        <p class="empty-state">No debug submissions yet</p>
      </div>
    </div>

    <!-- Sidebar Metrics -->
    <div class="debug-metrics">
      <div class="metric-item">
        <span class="metric-label">Total Submissions:</span>
        <span id="total-submissions" class="metric-value">0</span>
      </div>
      <div class="metric-item">
        <span class="metric-label">Last Submission:</span>
        <span id="last-submission-time" class="metric-value">--:--</span>
      </div>
    </div>
  </div>
</div>
```

### Debug Panel JavaScript

```javascript
// src/ui/debug-panel.js
class DebugPanel {
  constructor() {
    this.history = [];
    this.batchMode = false;
    this.init();
  }

  init() {
    this.setupEventListeners();
    this.loadHistory();
  }

  setupEventListeners() {
    // Debug flag buttons
    document.querySelectorAll('[data-debug-flag]').forEach(btn => {
      btn.addEventListener('click', (e) => this.handleDebugFlag(e));
    });

    // Mock payload toggle
    document.getElementById('mock-payload-toggle').addEventListener('change', (e) => {
      this.togglePayloadOptions(e.target.checked);
    });

    // Payload template selector
    document.getElementById('payload-template').addEventListener('change', (e) => {
      this.updatePayloadPreview(e.target.value);
    });

    // Batch mode toggle
    document.getElementById('batch-mode-toggle').addEventListener('change', (e) => {
      this.batchMode = e.target.checked;
    });

    // Quick templates
    document.querySelectorAll('[data-template]').forEach(btn => {
      btn.addEventListener('click', (e) => this.submitQuickTemplate(e));
    });

    // Clear history
    document.getElementById('clear-history-btn').addEventListener('click', () => {
      this.clearHistory();
    });

    // Keyboard shortcuts
    document.addEventListener('keydown', (e) => this.handleKeyboardShortcuts(e));
  }

  async handleDebugFlag(event) {
    const debugFlag = event.target.dataset.debugFlag;
    const payload = this.buildPayload();

    try {
      event.target.disabled = true;
      event.target.textContent = 'Submitting...';

      let url = '/events?debug=' + debugFlag;
      if (debugFlag === 'queue_delay') {
        const delay = document.getElementById('delay-input').value;
        url += `&delay=${delay}`;
      }

      const response = await fetch(url, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${this.getToken()}`
        },
        body: JSON.stringify(payload)
      });

      const data = await response.json();
      this.addToHistory(debugFlag, response.status, data);
      this.updateMetrics();

      event.target.disabled = false;
      event.target.textContent = `Trigger ${debugFlag.replace(/_/g, ' ')}`;

    } catch (error) {
      console.error('Debug submission failed:', error);
      alert(`Error: ${error.message}`);
    }
  }

  buildPayload() {
    const useMockPayload = document.getElementById('mock-payload-toggle').checked;
    const template = document.getElementById('payload-template').value;

    if (!useMockPayload) {
      return { payload: { test: true } };
    }

    const payloads = {
      'minimal': { payload: { test: true } },
      'user-created': {
        payload: {
          user_id: 'usr_' + Math.random().toString(36).substr(2, 9),
          email: 'user@example.com',
          created_at: new Date().toISOString()
        },
        metadata: { event_type: 'user.created', source: 'auth-service' }
      },
      'order-placed': {
        payload: {
          order_id: 'ord_' + Math.random().toString(36).substr(2, 9),
          amount: Math.floor(Math.random() * 10000) / 100,
          customer_id: 'cust_' + Math.random().toString(36).substr(2, 9),
          items: [{ sku: 'ITEM-001', quantity: 1, price: 29.99 }]
        },
        metadata: { event_type: 'order.placed', source: 'orders-service' }
      }
    };

    if (template === 'custom') {
      try {
        return JSON.parse(document.getElementById('custom-payload').value);
      } catch (e) {
        alert('Invalid JSON in custom payload');
        return payloads['minimal'];
      }
    }

    return payloads[template] || payloads['minimal'];
  }

  addToHistory(flag, status, response) {
    const entry = {
      timestamp: new Date(),
      flag,
      event_id: response?.data?.event_id || 'N/A',
      status: status,
      response: response
    };

    this.history.unshift(entry);
    if (this.history.length > 10) {
      this.history.pop();
    }

    this.renderHistory();
    localStorage.setItem('debugHistory', JSON.stringify(this.history));
  }

  renderHistory() {
    const historyDiv = document.getElementById('debug-history');
    if (this.history.length === 0) {
      historyDiv.innerHTML = '<p class="empty-state">No debug submissions yet</p>';
      return;
    }

    historyDiv.innerHTML = this.history.map((entry, index) => `
      <div class="history-entry" data-status="${entry.status}">
        <div class="entry-header">
          <span class="timestamp">${entry.timestamp.toLocaleTimeString()}</span>
          <span class="flag-badge">${entry.flag}</span>
          <span class="status-badge">${entry.status}</span>
        </div>
        <div class="entry-details">
          <div>Event ID: <code>${entry.event_id}</code></div>
          <button class="expand-btn" onclick="debugPanel.toggleDetails(${index})">Show Response</button>
          <div class="details hidden" id="details-${index}">
            <pre>${JSON.stringify(entry.response, null, 2)}</pre>
          </div>
        </div>
      </div>
    `).join('');
  }

  toggleDetails(index) {
    const detailsDiv = document.getElementById(`details-${index}`);
    detailsDiv.classList.toggle('hidden');
  }

  loadHistory() {
    const saved = localStorage.getItem('debugHistory');
    if (saved) {
      this.history = JSON.parse(saved);
      this.renderHistory();
    }
  }

  clearHistory() {
    if (confirm('Clear all debug history?')) {
      this.history = [];
      localStorage.removeItem('debugHistory');
      this.renderHistory();
    }
  }

  updateMetrics() {
    document.getElementById('total-submissions').textContent = this.history.length;
    if (this.history.length > 0) {
      const lastTime = this.history[0].timestamp;
      document.getElementById('last-submission-time').textContent = lastTime.toLocaleTimeString();
    }
  }

  togglePayloadOptions(enabled) {
    const selector = document.getElementById('payload-template');
    const custom = document.getElementById('custom-payload');
    selector.disabled = !enabled;
    if (!enabled) custom.classList.add('hidden');
  }

  updatePayloadPreview(template) {
    const custom = document.getElementById('custom-payload');
    if (template === 'custom') {
      custom.classList.remove('hidden');
    } else {
      custom.classList.add('hidden');
    }
  }

  async submitQuickTemplate(event) {
    const template = event.target.dataset.template;
    const payloads = {
      'user-created': {
        payload: { user_id: 'usr_' + Math.random().toString(36).substr(2, 9), email: 'user@example.com' },
        metadata: { event_type: 'user.created' }
      },
      'order-placed': {
        payload: { order_id: 'ord_' + Math.random().toString(36).substr(2, 9), amount: 99.99 },
        metadata: { event_type: 'order.placed' }
      },
      'payment': {
        payload: { payment_id: 'pay_' + Math.random().toString(36).substr(2, 9), amount: 199.99 },
        metadata: { event_type: 'payment.completed' }
      },
      'webhook': {
        payload: { webhook_id: 'wh_' + Math.random().toString(36).substr(2, 9), data: {} },
        metadata: { event_type: 'webhook.received' }
      }
    };

    const payload = payloads[template];
    try {
      const response = await fetch('/events', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${this.getToken()}`
        },
        body: JSON.stringify(payload)
      });

      const data = await response.json();
      this.addToHistory(`template:${template}`, response.status, data);
      this.updateMetrics();
    } catch (error) {
      console.error('Template submission failed:', error);
    }
  }

  handleKeyboardShortcuts(event) {
    if (event.altKey) {
      if (event.key === 'd') {
        document.getElementById('debug-toggle-btn').click();
      } else if (event.key === '1') {
        document.querySelector('[data-debug-flag="validation_error"]').click();
      } else if (event.key === '2') {
        document.querySelector('[data-debug-flag="processing_error"]').click();
      } else if (event.key === '3') {
        document.querySelector('[data-debug-flag="queue_delay"]').click();
      } else if (event.key === '4') {
        document.querySelector('[data-debug-flag="dlq_routing"]').click();
      }
    }
  }

  getToken() {
    return localStorage.getItem('apiToken') || 'demo-token';
  }
}

// Initialize on page load
document.addEventListener('DOMContentLoaded', () => {
  window.debugPanel = new DebugPanel();
});
```

### CSS Styling

```css
/* src/ui/debug-panel.css */
.debug-panel {
  border: 2px solid #e5e7eb;
  border-radius: 8px;
  background: #fafafa;
  padding: 16px;
  margin-bottom: 20px;
}

.debug-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
}

.debug-header h2 {
  margin: 0;
  font-size: 18px;
  font-weight: 600;
}

.debug-header .subtitle {
  margin: 4px 0 0 0;
  font-size: 14px;
  color: #6b7280;
}

.debug-cards-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 16px;
  margin-bottom: 20px;
}

.debug-card {
  border: 1px solid #d1d5db;
  border-radius: 6px;
  padding: 12px;
  background: white;
  transition: box-shadow 0.2s;
}

.debug-card:hover {
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.card-header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 8px;
}

.card-icon {
  font-size: 20px;
}

.card-description {
  font-size: 13px;
  color: #4b5563;
  margin: 8px 0;
  line-height: 1.4;
}

.debug-btn {
  width: 100%;
  padding: 8px 12px;
  border: none;
  border-radius: 4px;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  margin-top: 8px;
}

.debug-btn.primary {
  background: #3b82f6;
  color: white;
}

.debug-btn.primary:hover:not(:disabled) {
  background: #2563eb;
}

.debug-btn:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

.expected-result {
  font-size: 12px;
  color: #9ca3af;
  margin: 8px 0 0 0;
  font-style: italic;
}

.debug-section {
  margin-top: 16px;
  padding-top: 16px;
  border-top: 1px solid #e5e7eb;
}

.debug-section h4 {
  margin: 0 0 12px 0;
  font-size: 14px;
  font-weight: 600;
}

.checkbox-label {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 14px;
  cursor: pointer;
  margin-bottom: 12px;
}

.payload-select,
.input-group input {
  width: 100%;
  padding: 8px;
  border: 1px solid #d1d5db;
  border-radius: 4px;
  font-size: 14px;
  margin-bottom: 8px;
}

.custom-payload {
  width: 100%;
  min-height: 100px;
  padding: 8px;
  border: 1px solid #d1d5db;
  border-radius: 4px;
  font-family: monospace;
  font-size: 12px;
}

.custom-payload.hidden {
  display: none;
}

.quick-templates {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: 8px;
}

.template-btn {
  padding: 8px;
  background: #f3f4f6;
  border: 1px solid #d1d5db;
  border-radius: 4px;
  cursor: pointer;
  font-size: 13px;
  transition: all 0.2s;
}

.template-btn:hover {
  background: #e5e7eb;
  border-color: #9ca3af;
}

.progress-bar {
  width: 100%;
  height: 24px;
  background: #e5e7eb;
  border-radius: 4px;
  overflow: hidden;
  position: relative;
  margin: 12px 0;
}

.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, #3b82f6, #2563eb);
  width: 0%;
  transition: width 0.3s;
}

.progress-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 12px;
  font-weight: 600;
  color: #1f2937;
}

.progress-bar.hidden {
  display: none;
}

.debug-history {
  max-height: 300px;
  overflow-y: auto;
}

.history-entry {
  padding: 8px;
  border-left: 3px solid #3b82f6;
  background: white;
  margin-bottom: 8px;
  border-radius: 4px;
  font-size: 12px;
}

.history-entry[data-status="200"],
.history-entry[data-status="201"] {
  border-left-color: #10b981;
}

.history-entry[data-status="400"],
.history-entry[data-status="401"],
.history-entry[data-status="404"],
.history-entry[data-status="409"] {
  border-left-color: #f59e0b;
}

.history-entry[data-status="500"],
.history-entry[data-status="503"] {
  border-left-color: #ef4444;
}

.entry-header {
  display: flex;
  gap: 8px;
  margin-bottom: 8px;
}

.timestamp {
  color: #6b7280;
}

.flag-badge,
.status-badge {
  padding: 2px 6px;
  border-radius: 3px;
  background: #f3f4f6;
  font-weight: 500;
}

.expand-btn {
  background: none;
  border: none;
  color: #3b82f6;
  cursor: pointer;
  font-size: 12px;
  text-decoration: underline;
  margin-left: 8px;
}

.details {
  margin-top: 8px;
  padding: 8px;
  background: #f9fafb;
  border-radius: 4px;
  font-family: monospace;
  overflow-x: auto;
}

.details.hidden {
  display: none;
}

.details pre {
  margin: 0;
  font-size: 11px;
}

.empty-state {
  color: #9ca3af;
  font-style: italic;
  text-align: center;
  padding: 20px;
}

.debug-metrics {
  margin-top: 16px;
  padding-top: 16px;
  border-top: 1px solid #e5e7eb;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 12px;
}

.metric-item {
  display: flex;
  flex-direction: column;
  font-size: 13px;
}

.metric-label {
  color: #6b7280;
  font-weight: 500;
}

.metric-value {
  color: #1f2937;
  font-weight: 600;
  margin-top: 4px;
}

@media (max-width: 768px) {
  .debug-cards-grid {
    grid-template-columns: 1fr;
  }

  .quick-templates {
    grid-template-columns: repeat(2, 1fr);
  }
}
```

## Implementation Workflow

1. **Create Debug Panel Component**
   - Add HTML structure in `src/ui/index.html`
   - Organize into collapsible sections
   - Create responsive layout with grid for debug cards

2. **Implement JavaScript Class**
   - Build DebugPanel class with event listeners
   - Implement handleDebugFlag method for API submission
   - Add payload building logic with templates

3. **Add Styling**
   - Style debug panel with distinct visual hierarchy
   - Color-code cards by error type
   - Responsive design for mobile

4. **Integrate Mock Payloads**
   - Create payload templates for common Zapier events
   - Add template selector UI
   - Support custom JSON input

5. **Implement History Tracking**
   - Store debug submissions in array
   - Persist to localStorage
   - Display last 10 submissions with status

6. **Add Batch Mode**
   - Implement sequential submission of all flags
   - Show progress bar with 4-step progress
   - Collect and display results

7. **Keyboard Shortcuts**
   - Register Alt+D for panel toggle
   - Register Alt+1-4 for quick flag submission
   - Display help on focus

8. **Test All Scenarios**
   - Submit each debug flag individually
   - Verify proper API parameter passing
   - Test with different payloads
   - Verify batch mode execution
   - Test error handling and display

## Verification Checklist

- [ ] Debug panel displays all 4 flag cards
- [ ] Each flag card shows correct icon and description
- [ ] Validation error flag submits with correct parameter
- [ ] Processing error flag submits with correct parameter
- [ ] Queue delay flag includes latency input
- [ ] DLQ routing flag submits with correct parameter
- [ ] Mock payload toggle works and shows templates
- [ ] Custom payload textarea functions
- [ ] Quick event generator buttons work
- [ ] History displays last 10 submissions
- [ ] Status badges color-code correctly
- [ ] Batch mode executes all 4 flags sequentially
- [ ] Progress bar shows correct progress
- [ ] Keyboard shortcuts function (Alt+D, Alt+1-4)
- [ ] Clear history button works
- [ ] Mobile responsive layout
- [ ] Latency injection shows proper delay

## Notes

- Use vanilla JavaScript for consistency with existing UI
- All API calls include proper Authorization header
- Store debug history in localStorage for persistence
- Color coding: validation=orange, processing=red, delay=yellow, dlq=red
- Consider rate limiting on rapid submissions
- Mock payloads should be realistic Zapier event examples
- Help modal should link to PRD debug documentation

## Related Stories

- **1.2:** API Worker with POST /events endpoint
- **1.5:** Error handling and structured responses
- **1.6:** UI skeleton and base dashboard
- **5.2:** Visual feedback (toasts) for debug submissions
- **5.3:** Event flow visualization to show debug path

---

## Dev Agent Record

*To be filled by development agent*

---

## QA Results

*To be filled by QA agent*
